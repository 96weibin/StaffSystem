"use strict";function _typeof(t){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}window.onload=function(){document.getElementsByTagName("body")[0].innerHTML='\n\t\t\t<header>\n\t\t\t\t<div class="title">用户管理</div>\n\t\t\t\t<div class="logo">maxxis</div>\n\t\t\t\t<div class="userControl">\n\t\t\t\t\t<div class="userIcon">游客</div>\n\t\t\t\t\t<div class="userName">请登录</div>\n\t\t\t\t</div>\n\t\t\t</header>\n\t\t\t<section>\n\t\t\t\t<div class="addBtn">添加新员</div>\n\t\t\t\t<div class="lookInfoBtn">查看信息</div>\n\t\t\t\t<div class="adminLoginBox">\n\t\t\t\t\t<div class="userSwitch">管理员登录</div>\n\t\t\t\t\t<input type="text" name="username" placeholder="请输入账号" class="adminName">\n\t\t\t\t\t<input type="password" name="password" placeholder="请输入密码" class="adminPass">\n\t\t\t\t\t<input type="button" value="管理员登录" class="adminLogin">\n\t\t\t\t</div>\n\t\t\t\t<div class="addStaffModal">\n\t\t\t\t\t<div class="baseInfo">\n\t\t\t\t\t\t<h3>基础信息</h3>\n\t\t\t\t\t\t<div>\n\t\t\t\t\t\t\t<span>电话号码:</span><input type="text" name="newPhone">\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div>\n\t\t\t\t\t\t\t<span>员工编号:</span><input type="text" name="newNumber">\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div>\n\t\t\t\t\t\t\t<span>员工姓名:</span><input type="text" name="newName">\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div>\n\t\t\t\t\t\t\t<span>性&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;别:</span>&nbsp;&nbsp;&nbsp;\n\t\t\t\t\t\t\t<span>男</span><input type="radio" class="male" checked="checked" name="sex">\n\t\t\t\t\t\t\t<span>女</span><input type="radio" class="female" name="sex">\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div>\n\t\t\t\t\t\t\t<span>所在部门:</span><input type="text" name="newDepartment">\n\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t<div>\n\t\t\t\t\t\t\t<span>身份证号:</span><input type="text" name="newIDCard">\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div>\n\t\t\t\t\t\t\t<span>加入时间:</span><input type="date" name="newJoinDate">\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div>\n\t\t\t\t\t\t\t<span>员工生日:</span><input type="date" name="newBirthday">\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class="educationInfo">\n\t\t\t\t\t\t<h3>学习经历</h3>\n\t\t\t\t\t\t<div class="experience">\n\t\t\t\t\t\t\t<span>起始时间</span><input type="date" name="startDate">\n\t\t\t\t\t\t\t<span>描述</span><input type="text" name="description">\n\t\t\t\t\t\t\t<span>截止时间</span><input type="date" name="endDate">\n\t\t\t\t\t\t\t<span class="deleteExperience">X</span>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class="addExperience">添加经历</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class="closeModal">关闭</div>\n\t\t\t\t\t<div class="sendStaffInfo">提交</div>\n\t\t\t\t\t<div class="upData">更新</div>\n\t\t\t\t</div>\n\t\t\t\t<div class="viewInfoModal">\n\t\t\t\t\t<input type="search" placeholder="请输入 姓名/工号" class="searchInput" autofocus>\n\t\t\t\t\t<div class="searchBtn">查询</div>\n\t\t\t\t\t<div class="closeViewModal">关闭</div>\n\t\t\t\t\t<div class="viewInfoBox">\n\n\t\t\t\t\t\t<div class="infoTitle">\n\t\t\t\t\t\t\t<div class="staffNumber">员工编号</div>\n\t\t\t\t\t\t\t<div class="staffName">姓名</div>\n\t\t\t\t\t\t\t<div class="staffDepartment">部门</div>\n\t\t\t\t\t\t\t<div class="staffPhone">电话</div>\n\t\t\t\t\t\t\t<div class="info">详细</div>\n\t\t\t\t\t\t\t<div class="write">编辑</div>\n\t\t\t\t\t\t\t<div class="delete">删除</div>\n\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t\x3c!-- <div class="infoItem">\n\t\t\t\t\t\t\t<div class="staffNumber">182722</div>\n\t\t\t\t\t\t\t<div class="staffName">赵伟斌</div>\n\t\t\t\t\t\t\t<div class="staffDepartment">咨询部-自动化系统组</div>\n\t\t\t\t\t\t\t<div class="staffPhone">15764501228</div>\n\t\t\t\t\t\t\t<div class="info">></div>\n\t\t\t\t\t\t\t<div class="write">/</div>\n\t\t\t\t\t\t\t<div class="delete">X</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class="detailInfoBox">\n\t\t\t\t\t\t\t<div class="moreInfo">\n\t\t\t\t\t\t\t\t<div class="idCardName">身份证:</div><div class="idCard">23102419961228301X</div>\n\t\t\t\t\t\t\t\t<div class="sexName">性别:</div><div class="sex">male</div>\n\t\t\t\t\t\t\t\t<div class="joinDateName">加入时间:</div><div class="joinDate">2018-8-1</div>\n\t\t\t\t\t\t\t\t<div class="birthdayName">生日:</div><div class="birthday">1996-12-28</div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div class="experienceItem">\n\t\t\t\t\t\t\t\t<div class="startDate">2014-9-1</div>\n\t\t\t\t\t\t\t\t<span>~</span><div class="endDate">2018-6-30</div>\n\t\t\t\t\t\t\t\t<div></div><div class="description">哈尔滨理工大学,测控技术与通信工程系</div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div> --\x3e\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</section>\n\t\t\t<footer>footer</footer>\n\t\t';var t,y,b,N,x,S,T,E,L,n=document.getElementsByClassName("adminName")[0],a=document.getElementsByClassName("adminPass")[0],e=document.getElementsByClassName("adminLogin")[0],i=document.getElementsByClassName("adminLoginBox")[0],s=document.getElementsByClassName("userName")[0],d=document.getElementsByClassName("userIcon")[0],l=document.getElementsByClassName("addBtn")[0],r=document.getElementsByClassName("lookInfoBtn")[0],o=document.getElementsByTagName("section")[0],c=document.getElementsByClassName("addStaffModal")[0],u=document.getElementsByClassName("title")[0],M=document.getElementsByTagName("footer")[0],p=document.getElementsByClassName("addExperience")[0],v=document.getElementsByClassName("educationInfo")[0],m=document.getElementsByClassName("deleteExperience")[0],g=document.getElementsByClassName("closeModal")[0],f=document.getElementsByClassName("sendStaffInfo")[0],h=document.getElementsByClassName("upData")[0],C=document.getElementsByName("newPhone")[0],H=document.getElementsByName("newNumber")[0],B=document.getElementsByName("newName")[0],A=document.getElementsByClassName("male")[0],I=document.getElementsByClassName("female")[0],D=document.getElementsByName("newDepartment")[0],w=document.getElementsByName("newIDCard")[0],k=document.getElementsByName("newJoinDate")[0],j=document.getElementsByName("newBirthday")[0],J=document.getElementsByClassName("lookInfoBtn")[0],P=document.getElementsByClassName("viewInfoModal")[0],X=document.getElementsByClassName("viewInfoBox")[0],$=document.getElementsByClassName("closeViewModal")[0],O=document.getElementsByClassName("infoTitle")[0],R=document.getElementsByClassName("searchBtn")[0],q=document.getElementsByClassName("searchInput")[0],z=document.getElementsByName("startDate"),F=document.getElementsByClassName("viewStartDate"),U=document.getElementsByName("description"),V=document.getElementsByClassName("viewDescription"),Z=document.getElementsByName("endDate"),_=document.getElementsByClassName("viewEndDate"),W=document.getElementsByClassName("infoItem"),G={};if(!K)var K={Sex:"male"};if("管理员登录"===sessionStorage.logInStatus&&(i.style.display="none",s.innerHTML=sessionStorage.adminName,d.innerHTML="管理",o.style.display="flex",o.style.justifyContent="center",l.style.marginLeft="100px",l.style.marginRight="100px",r.style.marginLeft="100px",r.style.marginRight="100px",M.innerHTML="欢迎管理员"+sessionStorage.adminName),"1"===sessionStorage.showStatus){c.style.display="block",M.innerHTML="添加员工信息";for(var Q=sessionStorage.experienceCount=1,Y=1;Y<Q;Y++){console.log(Y);var tt=document.createElement("div");tt.setAttribute("class","experience"),tt.innerHTML='\n\t\t\t\t\t\t\t<span>起始时间</span><input type="date" name="startDate">\n\t\t\t\t\t\t\t<span>描述</span><input type="text" name="description">\n\t\t\t\t\t\t\t<span>截止时间</span><input type="date" name="endDate">\n\t\t\t\t\t\t\t<span class="deleteExperience">X</span>\n\t\t\t\t\t\t\t',v.appendChild(tt),t=Y,document.getElementsByClassName("deleteExperience")[t].addEventListener("click",function(t){v.removeChild(t.target.parentNode),sessionStorage.experienceCount=sessionStorage.experienceCount-1})}}function et(){at()&&myAjax.post("http://172.17.147.2/staff/asp/addBaseInfo.asp",K,function(t,e){if(t)console.log(t);else{var n=JSON.parse(e);if(1===n.code)return M.innerHTML="输入的number已经存在 "+n.times+" 次，因为不允许number重复，是否要更新 "+n.Number+" 的信息？",void(h.style.display="block");for(var a,i=!1,s=0;s<sessionStorage.experienceCount;s++){var d={};d.StartTime=z[s].value,d.Description=U[s].value,d.EndTime=Z[s].value,d.Number=K.Number,console.log(d),myAjax.post("http://172.17.147.2/staff/asp/addExperienceInfo.asp",d,function(t,e){t?console.log(t):(console.log(e),0===(a=JSON.parse(e)).code&&(i=!0,console.log(i),console.log(a)))},!1)}i&&(console.log("success"),c.style.display="none",alert(a.Number+"号员工的信息添加成功!"),u.innerHTML="用户管理",sessionStorage.showStatus=0,sessionStorage.experienceCount=1,location.reload())}})}function nt(){P.style.display="block",sessionStorage.showStatus=2,myAjax.post("http://172.17.147.2/staff/asp/search.asp",{Status:1},function(t,e){t?console.log(t):0===(G=JSON.parse(e)).code&&it()})}function at(){if(!C)return!(M.innerHTML="请输入电话");if(!/^1\d{10}$/.test(C.value))return!(M.innerHTML="输入电话格式不匹配，请输入以1开头的11位数字");if(K.Phone=C.value,!H)return!(M.innerHTML="请输入员工编号");if(!/^\d{6}$/.test(H.value))return!(M.innerHTML="输入员工编号格式不匹配，请输入6位数字");if(K.Number=H.value,!B)return!(M.innerHTML="请输入员工姓名");if(!/^[a-zA-Z]|[\u4E00-\u9FA5]+$/.test(B.value))return!(M.innerHTML="员工姓名应为多个汉字或字母");if(K.Name=B.value,!D)return!(M.innerHTML="请输入员工所在部门");if(!/^[a-zA-Z]|[\u4E00-\u9FA5]|\d-+$/.test(D.value))return!(M.innerHTML="部门名仅为汉字,英文,和 - 组成");if(K.Department=D.value,!w)return!(M.innerHTML="请输入员工身份证号码");if(!/^\d{17}\d|X$/.test(w.value))return!(M.innerHTML="身份证号应有17为数字加一位数字或X");if(K.IDCard=w.value,!k)return!(M.innerHTML="请输入员工加入时间");if(!/\d{4}(-|\/|\.)\d{1,2}(-|\/|\.)\d{1,2}/.test(k.value))return!(M.innerHTML="时间格式 年-月-日");if(K.JoinDate=k.value,!j)return!(M.innerHTML="请输入员工生日");if(!/\d{4}(-|\/|\.)\d{1,2}(-|\/|\.)\d{1,2}/.test(j.value))return!(M.innerHTML="时间格式 年-月-日");if(K.Birthday=j.value,"0"===sessionStorage.experienceCount)return!1;for(var t=0;t<sessionStorage.experienceCount;t++){if(!(z[t].value&&U[t].value&&Z[t].value))return console.log(z[t].value+"------"+U[t].value+"-------------"+Z[t].value),M.innerHTML="第"+t+"条经历信息不全",!1;if(!/\d{4}(-|\/|\.)\d{1,2}(-|\/|\.)\d{1,2}/.test(z[t].value))return M.innerHTML="第"+t+"条经历的起始时间格式不匹配，应为yyyy-mm-dd",!1;if(!/\d{4}(-|\/|\.)\d{1,2}(-|\/|\.)\d{1,2}/.test(Z[t].value))return M.innerHTML="第"+t+"条经历的结束时间格式不匹配，应为yyyy-mm-dd",!1}return!0}function it(){for(var t=1;t<=G.count;t++){var e=document.createElement("div");e.setAttribute("class","infoItem"),e.setAttribute("data-index",t),e.innerHTML='\n\t\t\t\t<div class="staffNumber"><input typeof="text" value="'.concat(G.data[t].Number,'" disabled="disabled"> </div>\n\t\t\t\t<div class="staffName"><input typeof="text" value="').concat(G.data[t].Name,'" disabled="disabled"></div>\n\t\t\t\t<div class="staffDepartment"><input typeof="text" value="').concat(G.data[t].Department,'" disabled="disabled"></div>\n\t\t\t\t<div class="staffPhone"><input typeof="text" value="').concat(G.data[t].Phone,'" disabled="disabled"></div>\n\t\t\t\t<div class="info" data-flag="0">></div>\n\t\t\t\t<div class="write" data-flag="0"></div>\n\t\t\t\t<div class="delete">X</div>\n\t\t\t\t'),X.appendChild(e);var n=document.createElement("div");n.setAttribute("class","detailInfoBox"),X.appendChild(n)}var a=document.querySelectorAll(".infoItem .info");for(t=0;t<a.length;t++)a[t].addEventListener("click",dt);var i=document.querySelectorAll(".infoItem .delete");for(t=0;t<i.length;t++)i[t].addEventListener("click",lt);var s=document.querySelectorAll(".infoItem .write");for(t=0;t<s.length;t++)s[t].addEventListener("click",ot)}function st(t){if(q.value){var i=document.getElementsByClassName("detailInfoBox");isNaN(q.value)?myAjax.post("http://172.17.147.2/staff/asp/search.asp",{Status:"3",Value:q.value},function(t,e){if(t)console.log(t);else if(0===(G=JSON.parse(e)).code){for(var n=0,a=W.length;n<a;n++)X.removeChild(W[0]),X.removeChild(i[0]);it()}else 1===G.code&&(M.innerHTML="数据库中没有此数据！")}):myAjax.post("http://172.17.147.2/staff/asp/search.asp",{Status:"2",Value:q.value},function(t,e){if(t)console.log(t);else if(0===(G=JSON.parse(e)).code){for(var n=0,a=W.length;n<a;n++)X.removeChild(W[0]),X.removeChild(i[0]);it()}else 1===G.code&&(M.innerHTML="数据库中没有此数据！")})}else q.focus(),M.innerHTML="请输入要查询的内容"}function dt(d){if("管理员登录"===sessionStorage.logInStatus)if("0"===d.target.dataset.flag){for(var t=document.getElementsByClassName("detailInfoBox"),e=0;e<t.length;e++)t[e].innerHTML="",t[e].style.display="none",t[e].previousSibling.children[3].children[0].setAttribute("disabled","disabled"),t[e].previousSibling.children[2].children[0].setAttribute("disabled","disabled"),t[e].previousSibling.children[1].children[0].setAttribute("disabled","disabled"),t[e].previousSibling.children[5].setAttribute("data-flag",0),t[e].previousSibling.children[5].style.backgroundImage="url(http://172.17.147.2/staff/img/pen.png)",d.target.parentNode.nextSibling!==t[e]&&(t[e].previousSibling.children[4].setAttribute("data-flag",0),t[e].previousSibling.children[4].style.transform="rotate(0deg)");d.target.setAttribute("data-flag",1),d.target.style.transform="rotate(90deg)";var l=d.target.parentNode.dataset.index;myAjax.post("http://172.17.147.2/staff/asp/search.asp",{Status:4,value:d.target.parentNode.children[0].children[0].value},function(t,e){if(t)console.log(t);else{var n=JSON.parse(e);if(0===n.code){var a=document.createElement("div");a.setAttribute("class","moreInfo"),a.innerHTML='\n\t\t\t\t\t\t\t\t<div class="idCardName">身份证:</div><div class="idCard"><input type="text" disabled="disabled" value="'.concat(G.data[l].IDCard,'"></div>\n\t\t\t\t\t\t\t\t<div class="sexName">性别:</div><div class="sex"><input type="text" disabled="disabled" value="').concat(G.data[l].Sex,'"></div>\n\t\t\t\t\t\t\t\t<div class="joinDateName">加入时间:</div><div class="joinDate"><input type="text" disabled="disabled" value="').concat(G.data[l].JoinDate,'"></div>\n\t\t\t\t\t\t\t\t<div class="birthdayName">生日:</div><div class="birthday"><input type="text" disabled="disabled" value="').concat(G.data[l].Birthday,'"></div>\n\t\t\t\t\t\t\t'),d.target.parentNode.nextSibling.appendChild(a);for(var i=1;i<=n.count;i++){var s=document.createElement("div");s.setAttribute("class","experienceItem"),s.innerHTML='\n\t\t\t\t\t\t\t\t\t<div class="startDate"><input type="text" disabled="disabled" value="'.concat(n.data[i].StartTime,'"></div>\n\t\t\t\t\t\t\t\t\t<span>~</span>\n\t\t\t\t\t\t\t\t\t<div class="endDate"><input type="text" disabled="disabled" value="').concat(n.data[i].EndTime,'"></div>\n\t\t\t\t\t\t\t\t\t<div class="description"><input type="text" disabled="disabled" value="').concat(n.data[i].Description,'"></div>\n\t\t\t\t\t\t\t\t'),d.target.parentNode.nextSibling.appendChild(s)}d.target.parentNode.nextSibling.style.display="block"}}})}else d.target.setAttribute("data-flag",0),d.target.style.transform="rotate(0deg)",d.target.parentNode.nextSibling.style.display="none",d.target.parentNode.nextSibling.innerHTML="";else M.innerHTML="查看详细信息需管理员权限，请以管理员身份登录！"}function lt(t){if("管理员登录"===sessionStorage.logInStatus){var n=this.parentNode.children[0].children[0].value;window.confirm("确定要删除".concat(n,"此条信息？"))&&myAjax.post("http://172.17.147.2/staff/asp/delete.asp",{Number:this.parentNode.children[0].children[0].value},function(t,e){t?console.log(t):(alert(n+"的信息删除成功"),location.reload())})}else M.innerHTML="删除信息需管理员权限，请以管理员身份登录！"}"0"===sessionStorage.showStatus&&(c.style.display="none"),"2"===sessionStorage.showStatus&&(P.style.display="block",M.innerHTML="查看信息",nt());var rt={};function ot(o){if("管理员登录"===sessionStorage.logInStatus)if("0"===o.target.dataset.flag){for(var t=document.getElementsByClassName("detailInfoBox"),e=0;e<t.length;e++)t[e].innerHTML="",t[e].style.display="none",t[e].previousSibling.children[3].children[0].setAttribute("disabled","disabled"),t[e].previousSibling.children[2].children[0].setAttribute("disabled","disabled"),t[e].previousSibling.children[1].children[0].setAttribute("disabled","disabled"),t[e].previousSibling.children[4].setAttribute("data-flag",0),t[e].previousSibling.children[4].style.transform="rotate(0deg)",o.target.parentNode.nextSibling!==t[e]&&(t[e].previousSibling.children[5].style.backgroundImage="url(http://172.17.147.2/staff/img/pen.png)",t[e].previousSibling.children[5].setAttribute("data-flag",0));o.target.setAttribute("data-flag",1),this.style.backgroundImage="url(http://172.17.147.2/staff/img/right.png)";var c=o.target.parentNode.dataset.index;myAjax.post("http://172.17.147.2/staff/asp/search.asp",{Status:4,value:o.target.parentNode.children[0].children[0].value},function(t,e){if(t)console.log(t);else{var a=JSON.parse(e);if(0===a.code){var n=document.createElement("div");n.setAttribute("class","moreInfo"),"female"===G.data[c].Sex?otherSex="male":otherSex="female",n.innerHTML='\n\t\t\t\t\t\t\t\t<div class="idCardName">身份证:</div><div class="idCard"><input type="text"  value="'.concat(G.data[c].IDCard,'"></div>\n\t\t\t\t\t\t\t\t<div class="sexName">性别:</div><div class="sex"><select><option selected>').concat(G.data[c].Sex,"</potion><option>").concat(otherSex,'</option></select></div>\n\t\t\t\t\t\t\t\t<div class="joinDateName">加入时间:</div><div class="joinDate"><input type="text"  value="').concat(G.data[c].JoinDate,'"></div>\n\t\t\t\t\t\t\t\t<div class="birthdayName">生日:</div><div class="birthday"><input type="text"  value="').concat(G.data[c].Birthday,'"></div>\n\t\t\t\t\t\t\t'),o.target.parentNode.nextSibling.appendChild(n);for(var i=1;i<=a.count;i++){var s=document.createElement("div");s.setAttribute("class","experienceItem"),s.innerHTML='\n\t\t\t\t\t\t\t\t\t<div class="viewStartDate"><input type="text"  value="'.concat(a.data[i].StartTime,'"></div>\n\t\t\t\t\t\t\t\t\t<span>~</span>\n\t\t\t\t\t\t\t\t\t<div class="viewEndDate"><input type="text"  value="').concat(a.data[i].EndTime,'"></div>\n\t\t\t\t\t\t\t\t\t<div class="viewDescription"><input type="text" value="').concat(a.data[i].Description,'"></div>\n\t\t\t\t\t\t\t\t\t<div class="viewExperienceReduceBtn">-</div>\n\t\t\t\t\t\t\t\t'),o.target.parentNode.nextSibling.appendChild(s),s.lastChild.previousSibling.onclick=function(t){t.target.parentNode.parentNode.removeChild(this.parentNode),a.count--}}var d=document.createElement("div");d.setAttribute("class","viewExperienceAddBtn"),d.innerHTML="+",d.onclick=function(t){if(8<=a.count)M.innerHTML="已经够优秀了，这么多条够多了！";else{a.count++;var e=document.createElement("div");e.setAttribute("class","experienceItem"),e.innerHTML='\n\t\t\t\t\t\t\t\t\t\t<div class="viewStartDate"><input type="text"  value="起始时间"></div>\n\t\t\t\t\t\t\t\t\t\t<span>~</span>\n\t\t\t\t\t\t\t\t\t\t<div class="viewEndDate"><input type="text"  value="截止时间"></div>\n\t\t\t\t\t\t\t\t\t\t<div class="viewDescription"><input type="text" value="描述"></div>\n\t\t\t\t\t\t\t\t\t\t<div class="viewExperienceReduceBtn">-</div>\n\t\t\t\t\t\t\t\t\t',t.target.parentNode.appendChild(e);var n=document.querySelectorAll(".viewExperienceReduceBtn");n[n.length-1].onclick=function(t){t.target.parentNode.parentNode.removeChild(this.parentNode),a.count--}}},o.target.parentNode.nextSibling.appendChild(d),o.target.parentNode.nextSibling.style.display="block",o.target.parentNode.children[1].children[0].removeAttribute("disabled"),o.target.parentNode.children[2].children[0].removeAttribute("disabled"),o.target.parentNode.children[3].children[0].removeAttribute("disabled"),M.innerHTML="现在可以对"+o.target.parentNode.children[0].children[0].value+"的信息进行更改"}y=o.target.parentNode.children[0].children[0].value,b=o.target.parentNode.children[1].children[0].value,N=o.target.parentNode.children[2].children[0].value,x=o.target.parentNode.children[3].children[0].value,S=o.target.parentNode.nextSibling.children[0].children[1].children[0].value,T=o.target.parentNode.nextSibling.children[0].children[3].children[0].value,E=o.target.parentNode.nextSibling.children[0].children[5].children[0].value,L=o.target.parentNode.nextSibling.children[0].children[7].children[0].value;var l={};l.count=a.count;i=0;for(var r=a.count;i<r;i++)l[i]={oStartTime:F[i].children[0].value,oDescription:V[i].children[0].value,oEndTime:_[i].children[0].value,oNumber:y.value};!function t(e,n){var e=e||{};for(var a in n)"object"===_typeof(n[a])?(e[a]="Array"===n[a].constructor?[]:{},t(e[a],n[a])):e[a]=n[a];return e}(rt,l)}})}else{var n=o.target.parentNode.children[0].children[0],a=o.target.parentNode.children[1].children[0],i=o.target.parentNode.children[2].children[0],s=o.target.parentNode.children[3].children[0],d=o.target.parentNode.nextSibling.children[0].children[1].children[0],l=o.target.parentNode.nextSibling.children[0].children[3].children[0],r=o.target.parentNode.nextSibling.children[0].children[5].children[0],u=o.target.parentNode.nextSibling.children[0].children[7].children[0],p={};if(!s)return void(M.innerHTML="请输入电话");if(!/^1\d{10}$/.test(s.value))return void(M.innerHTML="输入电话格式不匹配，请输入以1开头的11位数字");if(p.Phone=s.value,!n)return void(M.innerHTML="请输入员工编号");if(!/^\d{6}$/.test(n.value))return void(M.innerHTML="输入员工编号格式不匹配，请输入6位数字");if(p.Number=n.value,!a)return void(M.innerHTML="请输入员工姓名");if(!/^[a-zA-Z]|[\u4E00-\u9FA5]+$/.test(a.value))return void(M.innerHTML="员工姓名应为多个汉字或字母");if(p.Name=a.value,!i)return void(M.innerHTML="请输入员工所在部门");if(!/^[a-zA-Z]|[\u4E00-\u9FA5]|\d-+$/.test(i.value))return void(M.innerHTML="部门名仅为汉字,英文,和 - 组成");if(p.Department=i.value,!d)return void(M.innerHTML="请输入员工身份证号码");if(!/^\d{17}\d|X$/.test(d.value))return void(M.innerHTML="身份证号应有17为数字加一位数字或X");if(p.IDCard=d.value,!r)return void(M.innerHTML="请输入员工加入时间");if(!/\d{4}(-|\/|\.)\d{1,2}(-|\/|\.)\d{1,2}/.test(r.value))return console.log(r.value),void(M.innerHTML="时间格式 年-月-日或 年/月/日");if(p.JoinDate=r.value,!u)return void(M.innerHTML="请输入员工生日");if(!/\d{4}(-|\/|\.)\d{1,2}(-|\/|\.)\d{1,2}/.test(u.value))return console.log(u.value),void(M.innerHTML="生日时间格式 年-月-日或 年/月/日");p.Birthday=u.value,p.Sex=l.value;var v=document.querySelectorAll(".experienceItem"),m={};if(m.count=v.length,0===v.length)return void(M.innerHTML="请输入至少一条经历");e=0;for(var g=v.length;e<g;e++)m[e]={StartTime:F[e].children[0].value,Description:V[e].children[0].value,EndTime:_[e].children[0].value,Number:p.Number};var f="是否要将";if(b!=a.value)f+="姓名:"+b+"--\x3e"+a.value;else if(N!=i.value)f+="部门:"+N+"--\x3e"+i.value;else if(x!=s.value)f+="电话"+x+"--\x3e"+s.value;else if(S!=d.value)f+="身份证号:"+S+"--\x3e"+d.value;else if(T!=l.value)f+="性别:"+T+"--\x3e"+l.value;else if(E!=r.value)f+="加入时间:"+E+"--\x3e"+r.value;else if(L!=u.value)f+="生日:"+L+"--\x3e"+u.value;else if(rt.count!==m.count)if(rt.count>m.count)f+="并且删除"+Math.abs(rt.count-m.count)+"条经历";else{f+="并且增加"+Math.abs(rt.count-m.count)+"条经历";for(e=0;e<m.count;e++){if(!(F[e].children[0].value&&V[e].children[0].value&&_[e].children[0].value))return console.log(F[e].children[0].value+"------"+V[e].children[0].value+"-------------"+_[e].children[0].value),M.innerHTML="第"+e-rt.count+"条经历信息不全",!1;if(!/\d{4}(-|\/|\.)\d{1,2}(-|\/|\.)\d{1,2}/.test(F[e].children[0].value))return M.innerHTML="第"+(e-rt.count+1)+"条经历的起始时间格式不匹配，应为yyyy-mm-dd",!1;if(!/\d{4}(-|\/|\.)\d{1,2}(-|\/|\.)\d{1,2}/.test(_[e].children[0].value))return M.innerHTML="第"+(e-rt.count+1)+"条经历的结束时间格式不匹配，应为yyyy-mm-dd",!1;if(""===V[e].children[0].value)return console.log(V[e].children[0].value),f+="第"+(e-rt.count+1)+"不能为空!",!1}}else{e=0;for(var h=m.count;e<h;e++)m[e].StartTime!==rt[e].oStartTime?f+="更改第"+(e+1)+"条经历的 起始时间："+rt[e].oStartTime+"--\x3e"+m[e].StartTime:m[e].EndTime!==rt[e].oEndTime?f+="更改第"+(e+1)+"条经历的 截止时间："+rt[e].oEndTime+"--\x3e"+m[e].EndTime:m[e].Description!==rt[e].oDescription&&(f+="更改第"+(e+1)+"条经历的 描述："+rt[e].oDescription+"--\x3e"+m[e].Description)}"是否要将"!==f?(console.log("有更改"+f),confirm(f)&&myAjax.post("http://172.17.147.2/staff/asp/delete.asp",{Number:y},function(t,e){t?console.log(t):(console.log(p),console.log(m),0===JSON.parse(e).code&&(myAjax.post("http://172.17.147.2/staff/asp/addBaseInfo.asp",p,function(t,e){if(t)console.log(t);else for(var n=0,a=m.count;n<a;n++)myAjax.post("http://172.17.147.2/staff/asp/addExperienceInfo.asp",m[n],function(t,e){t&&console.log(t)})},!1),o.target.setAttribute("data-flag",0),o.target.style.backgroundImage="url(http://172.17.147.2/staff/img/pen.png)",o.target.parentNode.children[1].children[0].setAttribute("disabled","disabled"),o.target.parentNode.children[2].children[0].setAttribute("disabled","disabled"),o.target.parentNode.children[3].children[0].setAttribute("disabled","disabled"),alert("信息更改成功！"),o.target.parentNode.nextSibling.style.display="none",o.target.parentNode.nextSibling.innerHTML="",M.innerHTML="查看信息",location.reload()))})):(console.log("没更改"+f),o.target.setAttribute("data-flag",0),o.target.style.backgroundImage="url(http://172.17.147.2/staff/img/pen.png)",o.target.parentNode.children[1].children[0].setAttribute("disabled","disabled"),o.target.parentNode.children[2].children[0].setAttribute("disabled","disabled"),o.target.parentNode.children[3].children[0].setAttribute("disabled","disabled"),o.target.parentNode.nextSibling.style.display="none",o.target.parentNode.nextSibling.innerHTML="",M.innerHTML="查看信息")}else M.innerHTML="编辑详细信息需管理员权限，请以管理员身份登录！"}e.onclick=function(t){if(n.value&&a.value){var e={UserName:n.value,PassWord:a.value};myAjax.post("http://172.17.147.2/staff/asp/adminLogin.asp",e,function(t,e){if(t)console.log(t);else{var n=JSON.parse(e);0===n.code?(i.style.display="none",s.innerHTML=n.data.UserName,d.innerHTML="管理",sessionStorage.logInStatus="管理员登录",sessionStorage.adminName=n.data.UserName,o.style.display="flex",o.style.justifyContent="center",l.style.marginLeft="100px",l.style.marginRight="100px",r.style.marginLeft="100px",r.style.marginRight="100px",M.innerHTML="欢迎管理员"+n.data.UserName):1===n.code&&(M.innerHTML=n.msg)}})}else M.innerHTML="用户员登录，能不能认真点，你这账号密码都没写全"},l.onclick=function(){"管理员登录"==sessionStorage.logInStatus?(c.style.display="block",sessionStorage.showStatus=1,M.innerHTML="添加新员工信息",u.innerHTML="添加新员工信息",sessionStorage.experienceCount||"1"!==sessionStorage.showStatus||(console.log("初始化  experienceCount 为1"),sessionStorage.experienceCount=1),K.Sex="male",A.onclick=function(){K.Sex="male"},I.onclick=function(){K.Sex="female"}):M.innerHTML="管理员未登录，游客不允许添加信息，请先登录"},p.onclick=function(t){if(8<=sessionStorage.experienceCount)M.innerHTML="行了你太优秀了这些就足够了";else{var e=document.createElement("div");e.setAttribute("class","experience"),e.innerHTML='\n\t\t\t\t\t\t\t<span>起始时间</span><input type="date" name="startDate">\n\t\t\t\t\t\t\t<span>描述</span><input type="text" name="description">\n\t\t\t\t\t\t\t<span>截止时间</span><input type="date" name="endDate">\n\t\t\t\t\t\t\t<span class="deleteExperience">X</span>\n\t\t\t\t\t',v.appendChild(e),document.getElementsByClassName("deleteExperience")[sessionStorage.experienceCount].addEventListener("click",function(t){v.removeChild(t.target.parentNode),sessionStorage.experienceCount=sessionStorage.experienceCount-1}),sessionStorage.experienceCount++}},m.onclick=function(t){v.removeChild(t.target.parentNode),sessionStorage.experienceCount=sessionStorage.experienceCount-1},g.onclick=function(){c.style.display="none",sessionStorage.showStatus=0,sessionStorage.experienceCount=1},f.onclick=et,h.onclick=function(){at()&&myAjax.post("http://172.17.147.2/staff/asp/delete.asp",{Number:K.Number},function(t,e){t?console.log(t):(et(),M.innerHTML="信息更新成功")})},J.onclick=nt,$.onclick=function(){sessionStorage.showStatus=0,location.reload()},X.onscroll=function(t){10<=t.target.scrollTop?(O.style.position="absolute",O.style.top=t.target.scrollTop-10+"px"):(O.style.position="relative",O.style.top=0)},R.onclick=st,q.onkeyup=st,d.onclick=function(){sessionStorage.logInStatus?confirm("确定要退出当前登录？")&&(sessionStorage.removeItem("logInStatus"),sessionStorage.showStatus=0,location.reload()):M.innerHTML="这没登录,去登录吧,就算你登录了这也没什么可管理的，也就能再退出，是不是很闲？"}};